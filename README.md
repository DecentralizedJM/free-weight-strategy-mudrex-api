```text
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  
â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  
â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â•šâ•â•     â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•
                                
â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
 â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•   
                                               
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• 
â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   
â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•    â•šâ•â•   
```
> **Advanced Multi-Strategy Crypto Bot for Mudrex & Bybit**

An advanced multi-indicator confluence trading strategy for crypto perpetual futures using Mudrex API and real-time Bybit WebSocket data.

---

## Architecture

### System Flow

```mermaid
flowchart TB
    subgraph DataSource["ğŸ“¡ Data Source"]
        WS["Bybit WebSocket<br/>V5 Linear Stream"]
    end
    
    subgraph DataLayer["ğŸ“Š Data Layer"]
        KH["Kline Handler<br/>OHLCV Storage"]
        TH["Ticker Handler<br/>OI & Funding History"]
    end
    
    subgraph Indicators["ğŸ“ˆ Technical Indicators"]
        EMA["EMA<br/>9/21 Crossover"]
        RSI["RSI<br/>Overbought/Oversold"]
        MACD["MACD<br/>Signal Crossover"]
        ATR["ATR<br/>Volatility"]
    end
    
    subgraph MarketData["ğŸ” Market Analysis"]
        OI["Open Interest<br/>Z-Score & Confirmation"]
        FR["Funding Rate<br/>Squeeze Detection"]
    end
    
    subgraph Strategy["ğŸ§  Strategy Engine"]
        CONF["Confluence Scoring<br/>5 Indicators Ã— 20% each"]
        SIG["Signal Generation<br/>LONG / SHORT / NEUTRAL"]
    end
    
    subgraph Execution["âš¡ Execution Layer"]
        EXEC["Trade Executor<br/>Mudrex SDK"]
        PM["Position Manager<br/>Risk Controls"]
    end
    
    subgraph Exchange["ğŸ¦ Exchange"]
        MX["Mudrex API<br/>Order Execution"]
    end
    
    WS --> KH
    WS --> TH
    KH --> EMA
    KH --> RSI
    KH --> MACD
    KH --> ATR
    TH --> OI
    TH --> FR
    EMA --> CONF
    RSI --> CONF
    MACD --> CONF
    OI --> CONF
    FR --> CONF
    ATR --> SIG
    CONF --> SIG
    SIG --> EXEC
    EXEC --> PM
    EXEC --> MX
    PM --> MX
```

### Detailed Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           FREE WEIGHT STRATEGY                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   BYBIT WEBSOCKET     â”‚         â”‚        MUDREX API                  â”‚  â”‚
â”‚   â”‚   (Real-Time Data)    â”‚         â”‚     (Order Execution)              â”‚  â”‚
â”‚   â”‚                       â”‚         â”‚                                    â”‚  â”‚
â”‚   â”‚  â€¢ Kline/Candlestick  â”‚         â”‚  â€¢ Market Orders                   â”‚  â”‚
â”‚   â”‚  â€¢ Ticker/Price       â”‚         â”‚  â€¢ Stop-Loss/Take-Profit           â”‚  â”‚
â”‚   â”‚  â€¢ Open Interest      â”‚         â”‚  â€¢ Position Management             â”‚  â”‚
â”‚   â”‚  â€¢ Funding Rate       â”‚         â”‚  â€¢ Balance/Wallet                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â”‚                                    â–²                        â”‚
â”‚               â–¼                                    â”‚                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                         DATA HANDLERS                                 â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚   â”‚   Kline Handler     â”‚    â”‚      Ticker Handler                 â”‚  â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ OHLCV storage   â”‚    â”‚   â€¢ Price updates                   â”‚  â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ History buffer  â”‚    â”‚   â€¢ OI history tracking             â”‚  â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ Candle confirm  â”‚    â”‚   â€¢ Funding rate history            â”‚  â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚                                  â”‚                        â”‚
â”‚                 â–¼                                  â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                      TECHNICAL INDICATORS                             â”‚ â”‚
â”‚   â”‚                                                                       â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚   â”‚   â”‚     EMA     â”‚ â”‚     RSI     â”‚ â”‚    MACD     â”‚ â”‚      ATR        â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  (9 & 21)   â”‚ â”‚   (14)      â”‚ â”‚ (12/26/9)   â”‚ â”‚     (14)        â”‚ â”‚ â”‚
â”‚   â”‚   â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚                 â”‚ â”‚ â”‚
â”‚   â”‚   â”‚ â€¢ Crossover â”‚ â”‚ â€¢ Oversold  â”‚ â”‚ â€¢ Crossover â”‚ â”‚ â€¢ Volatility    â”‚ â”‚ â”‚
â”‚   â”‚   â”‚ â€¢ Trend     â”‚ â”‚ â€¢ Overboughtâ”‚ â”‚ â€¢ Histogram â”‚ â”‚ â€¢ Dynamic SL/TP â”‚ â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚               â”‚               â”‚                 â”‚            â”‚
â”‚              â–¼               â–¼               â–¼                 â–¼            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                       MARKET DATA ANALYZERS                           â”‚ â”‚
â”‚   â”‚                                                                       â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚   â”‚   â”‚     OPEN INTEREST (OI)      â”‚  â”‚       FUNDING RATE             â”‚ â”‚ â”‚
â”‚   â”‚   â”‚                             â”‚  â”‚                                â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Z-Score calculation      â”‚  â”‚  â€¢ Sentiment analysis          â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Trend confirmation       â”‚  â”‚  â€¢ Squeeze detection           â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Extreme detection        â”‚  â”‚  â€¢ Annualized rate             â”‚ â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                 â”‚                    â”‚
â”‚                      â–¼                                 â–¼                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                        STRATEGY ENGINE                                â”‚ â”‚
â”‚   â”‚                                                                       â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚   â”‚   â”‚                  CONFLUENCE SCORING                          â”‚    â”‚ â”‚
â”‚   â”‚   â”‚                                                              â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â”‚ EMA 20% â”‚ â”‚ RSI 20% â”‚ â”‚MACD 20% â”‚ â”‚ OI 20%  â”‚ â”‚FR 20%  â”‚ â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚    â”‚ â”‚
â”‚   â”‚   â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚ â”‚
â”‚   â”‚   â”‚                            â”‚                                 â”‚    â”‚ â”‚
â”‚   â”‚   â”‚                            â–¼                                 â”‚    â”‚ â”‚
â”‚   â”‚   â”‚                  Total Score: 0-100%                         â”‚    â”‚ â”‚
â”‚   â”‚   â”‚                                                              â”‚    â”‚ â”‚
â”‚   â”‚   â”‚         Entry Threshold: â‰¥60% AND â‰¥3/5 indicators            â”‚    â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚   â”‚                                                                       â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚   â”‚   â”‚                    SIGNAL GENERATION                         â”‚    â”‚ â”‚
â”‚   â”‚   â”‚                                                              â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ Signal Type: LONG / SHORT / NEUTRAL                      â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ Entry Price (current market)                             â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ Stop-Loss (ATR Ã— 1.5)                                    â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ Take-Profit (Risk:Reward = 2:1)                          â”‚    â”‚ â”‚
â”‚   â”‚   â”‚   â€¢ Position Size (max 2% capital)                           â”‚    â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚                                      â”‚
â”‚                                      â–¼                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                        TRADE EXECUTION                                â”‚ â”‚
â”‚   â”‚                                                                       â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚   â”‚   â”‚      TRADE EXECUTOR         â”‚  â”‚      POSITION MANAGER          â”‚ â”‚ â”‚
â”‚   â”‚   â”‚                             â”‚  â”‚                                â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Live/Dry-run mode        â”‚  â”‚  â€¢ Track open positions        â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Quantity calculation     â”‚  â”‚  â€¢ Max positions per symbol    â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Order placement          â”‚  â”‚  â€¢ PnL monitoring              â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Minimum order validation â”‚  â”‚  â€¢ Risk limit enforcement      â”‚ â”‚ â”‚
â”‚   â”‚   â”‚  â€¢ Mudrex SDK integration   â”‚  â”‚  â€¢ Exchange sync               â”‚ â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Project Structure

```
free-weight-strategy-mudrex-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                    # Main entry point
â”‚   â”œâ”€â”€ config.py                  # Configuration loader
â”‚   â”‚
â”‚   â”œâ”€â”€ bybit_ws/                  # Real-time data
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ client.py              # WebSocket client
â”‚   â”‚   â””â”€â”€ handlers.py            # Data handlers
â”‚   â”‚
â”‚   â”œâ”€â”€ indicators/                # Technical analysis
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ ema.py                 # EMA crossover
â”‚   â”‚   â”œâ”€â”€ rsi.py                 # RSI momentum
â”‚   â”‚   â”œâ”€â”€ macd.py                # MACD confirmation
â”‚   â”‚   â””â”€â”€ atr.py                 # ATR volatility
â”‚   â”‚
â”‚   â”œâ”€â”€ market_data/               # Derivatives metrics
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ open_interest.py       # OI analysis
â”‚   â”‚   â””â”€â”€ funding_rate.py        # Funding analysis
â”‚   â”‚
â”‚   â”œâ”€â”€ strategy/                  # Signal generation
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ engine.py              # Confluence engine
â”‚   â”‚   â””â”€â”€ signals.py             # Signal models
â”‚   â”‚
â”‚   â”œâ”€â”€ trading/                   # Order execution
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ executor.py            # Mudrex integration
â”‚   â”‚   â””â”€â”€ position_manager.py    # Position tracking
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ logger.py              # Logging config
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_indicators.py
â”‚   â””â”€â”€ test_strategy.py
â”‚
â”œâ”€â”€ config.example.yaml            # Config template
â”œâ”€â”€ .env.example                   # Environment variables
â”œâ”€â”€ requirements.txt               # Dependencies
â””â”€â”€ README.md
```

---

## Installation

### 1. Clone Repository

```bash
git clone https://github.com/DecentralizedJM/free-weight-strategy-mudrex-api.git
cd free-weight-strategy-mudrex-api
```

### 2. Install Dependencies

```bash
pip install -r requirements.txt
```

### 3. Configure

```bash
# Copy templates
cp config.example.yaml config.yaml
cp .env.example .env

# Edit .env with your API secret
MUDREX_API_SECRET=your_api_secret_here
DRY_RUN=true  # Start with dry-run mode
```

### 4. Run

```bash
# Dry-run (paper trading)
python -m src.main --dry-run

# Live trading
python -m src.main

# With custom config
python -m src.main --config path/to/config.yaml
```

---

## Strategy Details

### Indicator Weights

Each indicator contributes 20% to the total confluence score:

| Indicator | Weight | Long Condition | Short Condition |
|-----------|--------|----------------|-----------------|
| **EMA** | 20% | Fast (9) > Slow (21) | Fast (9) < Slow (21) |
| **RSI** | 20% | < 40 and recovering | > 60 and falling |
| **MACD** | 20% | MACD > Signal line | MACD < Signal line |
| **Open Interest** | 20% | Rising + Price rising | Rising + Price falling |
| **Funding Rate** | 20% | Short squeeze risk | Long squeeze risk |

### Entry Conditions

A trade signal is generated when:
- **Confluence Score â‰¥ 60%** (at least 3 indicators aligned)
- **Minimum 3 out of 5 indicators** confirm the direction
- **Trade cooldown** period (5 minutes) has passed
- **No existing position** in the same direction

### Signal Types

| Signal | Action | Conditions |
|--------|--------|------------|
| **LONG** | Open long position | Bullish confluence â‰¥ 60% |
| **SHORT** | Open short position | Bearish confluence â‰¥ 60% |
| **NEUTRAL** | No action | Confluence < 60% or indicators mixed |

---

## Risk Management

### Position Sizing

```
Position Value = Available Balance Ã— Risk % Ã— Leverage
Quantity = Position Value / Entry Price
```

- **Max capital per trade**: 2%
- **Default leverage**: 5x (configurable)
- **Max positions per symbol**: 1

### Dynamic Stop-Loss (ATR-Based)

```
Long SL  = Entry Price - (ATR Ã— 1.5)
Short SL = Entry Price + (ATR Ã— 1.5)
```

### Take-Profit (Risk:Reward Ratio)

```
Risk Distance = |Entry - Stop-Loss|
TP Distance = Risk Distance Ã— 2.0  (2:1 R:R)

Long TP  = Entry Price + TP Distance
Short TP = Entry Price - TP Distance
```

---

## Configuration Reference

### `config.yaml`

```yaml
# Symbols to trade
symbols:
  - BTCUSDT
  - ETHUSDT

# Timeframe in minutes
timeframe: 5

# Indicator settings
indicators:
  ema:
    fast_period: 9
    slow_period: 21
  rsi:
    period: 14
    oversold: 30
    overbought: 70
  macd:
    fast_period: 12
    slow_period: 26
    signal_period: 9
  atr:
    period: 14

# Strategy parameters
strategy:
  min_confluence_score: 60
  min_indicators_aligned: 3
  trade_cooldown: 300  # seconds
  max_positions_per_symbol: 1

# Risk management
risk:
  max_capital_per_trade: 2.0  # percent
  default_leverage: 5
  stoploss_atr_multiplier: 1.5
  takeprofit_ratio: 2.0
```

### Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `MUDREX_API_SECRET` | Yes (live) | - | Mudrex API secret |
| `DRY_RUN` | No | `false` | Paper trading mode |
| `LOG_LEVEL` | No | `INFO` | Logging verbosity |

---

## Testing

```bash
# Run all tests
pytest tests/ -v

# Run specific test file
pytest tests/test_indicators.py -v

# Run with coverage
pytest tests/ --cov=src
```

---

## Data Flow

1. **Bybit WebSocket** streams real-time kline and ticker data
2. **Handlers** parse and store OHLCV, OI, and funding rate history
3. **Indicators** calculate EMA, RSI, MACD, ATR on each candle close
4. **Market Analyzers** compute OI z-score and funding sentiment
5. **Strategy Engine** evaluates confluence and generates signals
6. **Trade Executor** places orders via Mudrex API (or simulates in dry-run)
7. **Position Manager** tracks open positions and enforces risk limits

---

## API Integration

### Bybit (Data Source)

- **Endpoint**: `wss://stream.bybit.com/v5/public/linear`
- **Subscriptions**:
  - `kline.{interval}.{symbol}` - Candlestick data
  - `tickers.{symbol}` - Price, OI, funding rate

### Mudrex (Execution)

- **SDK**: `mudrex-api-trading-python-sdk`
- **Features**:
  - Symbol-first trading (e.g., "BTCUSDT")
  - Market orders with SL/TP
  - Leverage management
  - Position tracking

---

## Logging

Logs are written to console and optionally to file:

```
2025-02-09 18:45:23 | INFO     | src.main | WebSocket connected - Receiving market data
2025-02-09 18:45:24 | INFO     | src.strategy.engine | SIGNAL: BTCUSDT LONG | Score: 80% | Aligned: 4/5
2025-02-09 18:45:24 | INFO     | src.trading.executor | âœ… Trade executed: LONG 0.001 BTCUSDT @ market
```

Configure in `config.yaml`:
```yaml
logging:
  level: INFO
  file: logs/trading.log
  max_size: 10  # MB
  backup_count: 5
```

---

## License

MIT License

---

## Disclaimer

âš ï¸ **This software is for educational purposes only.** Trading cryptocurrencies involves significant risk. Use at your own risk. The authors are not responsible for any financial losses.
